# Университетская информационная система

## О проекте

Это демонстрационное веб‑приложение, призванное облегчить цифровое взаимодействие между различными участниками вузовского сообщества: абитуриентами, студентами, преподавателями и руководством. Оно включает следующие разделы:

- **Расписание** — отображение списка занятий с возможностью записаться на конкретное мероприятие. В текущей версии расписание загружается из фиктивных данных, однако структура API позволяет заменить заглушки на реальные записи из базы данных.
- **События** — раздел для внеучебных мероприятий (хакатоны, семинары, концерты). Пока что используется небольшая предзагруженная выборка.
- **Обучение** — заглушка для будущих курсов, факультативов и цифровых кафедр.
- **Лидеры вузов** — рейтинг университетов по количеству баллов, которые набирают обучающиеся. Баллы суммируются по каждому вузу.
- **Профиль** — просмотр и редактирование имени пользователя, достижений и прогресса обучения. Роль пользователя (студент/преподаватель) определяется приглашением и в демонстрационной версии фиксирована.

Приложение разработано с использованием **React** и **TypeScript** на фронтенде и **FastAPI** на бэкенде. Для UI используется библиотека **Max UI** от MaxHub, подключённая через NPM и обёрнутая в провайдер. База данных — **PostgreSQL**, все сервисы развернуты с помощью **Docker** и **docker‑compose**.

## Установка и запуск

Необходимы установленный **Docker** и **docker‑compose**. Выполните следующие шаги в корне репозитория (`uni-app`):

```bash
docker compose build
docker compose up
```

После запуска сервисы будут доступны по адресам:

- **Frontend**: [http://localhost:3000](http://localhost:3000) — служит статические файлы через Nginx и проксирует `/api` на бекенд.
- **Backend API**: [http://localhost:8000](http://localhost:8000) — REST API FastAPI. Документация Swagger доступна по адресу `/docs`.
- **PostgreSQL**: порт `5432`, логин/пароль `postgres/postgres`.

Во время разработки можно запускать сервисы без Docker. Для бэкенда установите зависимости из `requirements.txt` и выполните:

```bash
uvicorn app.main:app --reload --port 8000
```

Для фронтенда перейдите в каталог `frontend`, установите зависимости через `npm install` и выполните `npm run dev`. Vite автоматически проксирует запросы, начинающиеся с `/api`, на порт 8000 (см. конфигурацию `vite.config.ts`).

## Архитектура

**Схема компонентов:**

1. **Пользователь** открывает веб‑приложение (адаптированное под мобильные устройства). Интерфейс отрисовывается React‑компонентами библиотеки Max UI, переключение тёмной/светлой темы реализовано локальным состоянием.
2. **Frontend** отправляет HTTP‑запросы на `/api/...`, которые Nginx перенаправляет на сервис **Backend**.
3. **Backend (FastAPI)** обрабатывает REST‑запросы, обращаясь к базе данных через SQLAlchemy. Бэкенд отвечает JSON‑структурами, описанными схемами Pydantic.
4. **PostgreSQL** хранит сущности: пользователи, университеты, занятия расписания, события, регистрации и т.д. При старте приложения создаются таблицы и добавляются несколько тестовых записей.

```
┌─────────────┐       HTTP        ┌─────────────┐       SQL        ┌─────────────┐
│  Браузер    │◄─────/api───────►│   FastAPI    │◄───────────────►│ PostgreSQL  │
│  (React)    │                  │  Backend    │                  │   База      │
└─────────────┘                  └─────────────┘                  └─────────────┘
```

## API

Краткое описание основных эндпоинтов:

| Метод | Путь                            | Описание                                                        |
|-------|----------------------------------|----------------------------------------------------------------|
| GET   | `/schedule?user_id={id}`         | Список занятий с флагом `signed_up` и количеством записавшихся |
| POST  | `/schedule/{schedule_id}/signup` | Запись пользователя (по `user_id`) на занятие                   |
| GET   | `/events`                        | Список внеучебных событий                                      |
| GET   | `/leaderboard`                   | Рейтинг вузов по баллам                                         |
| GET   | `/profile/{user_id}`             | Получить профиль пользователя                                   |
| PUT   | `/profile/{user_id}`             | Обновить имя, достижения и прогресс пользователя                |

Swagger‑UI доступен по адресу `/docs` на бэкенде.

## Тестирование

В каталоге `backend/tests` подготовлены тесты на базе `fastapi.testclient`, проверяющие основные бизнес‑сценарии: получение расписания, регистрация на занятия, работа профиля и таблицы лидеров. Для запуска тестов вне Docker требуется модуль `pytest`. В среде песочницы этот пакет отсутствует, поэтому тесты не были выполнены. Вы можете запустить их локально после установки зависимостей.

## Темная и светлая темы

Переключение темы реализовано на уровне фронтенда: состояние `darkMode` управляет добавлением класса `dark` на корневой контейнер. Компоненты библиотеки Max UI наследуют цветовую схему от стандартных CSS‑переменных. Кнопка в навигационной панели позволяет переключаться между тёмным и светлым оформлением без перезагрузки страницы.

## Потенциальный технический долг

1. **Отсутствие полноценной аутентификации.** Роли пользователей определяются по приглашению и передаются как `user_id` в запросах. Для реальной эксплуатации потребуется внедрение системы авторизации (JWT, OAuth) и разграничения прав. Без этого API уязвим для подмены идентификаторов.
2. **Хранение достижений в виде строки.** В модели пользователя достижения представлены как строка, что затрудняет поиск и изменение отдельных элементов. Лучше выделить отдельную таблицу `achievements` и связи `user_achievements`.
3. **Отсутствие миграций.** Таблицы создаются вызовом `create_all()`. При расширении схемы данных стоит подключить Alembic для управления версиями БД.
4. **Простая реализация темизации.** Тёмная/светлая тема реализована вручную. В комплекте Max UI, возможно, есть готовые механизмы переключения тем — стоит исследовать это и заменить самодельное решение.
5. **Минимальная обработка ошибок.** Клиентская часть выводит ошибки только в консоль. Необходимо добавить пользовательские уведомления и централизованную обработку исключений на бэкенде.

## Заключение

Данный шаблон демонстрирует структуру приложения для цифровой поддержки процессов в вузе. Он показывает, как быстро собрать фронтенд на React с помощью библиотеки Max UI и связать его с бэкендом на FastAPI и PostgreSQL. Дальнейшее развитие включает реализацию полноценной логики (редактирование расписания, интеграция с внешними сервисами), поддержку авторизации и расширение моделей данных.